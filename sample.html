<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ぐるなびAPIテスト</title>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<body>
  <h1>位置情報取得サンプル</h1>
  <button onclick="getPosition();">位置情報を取得する</button>
    <select id="color1">
      <option value="1" selected>選択してください</option>
      <option value="1">300m</option>
      <option value="2">500m</option>
      <option value="3">1000m</option>
    </select>
 <!-- <button onclick="clickBtn1();">送信</button> -->
  <table id="table" border="1">
    <tr><th>店舗名</th><th>営業時間</th></tr>
  </table>
  <script>
    // 現在地取得処理
    function getPosition() {
      // 現在地を取得
      navigator.geolocation.getCurrentPosition(
        // 取得成功した場合
        function(position) {
          var lat = position.coords.latitude ;
          var lng = position.coords.longitude ;
          var str = document.getElementById("color1").value;
          const url = "https://api.gnavi.co.jp/RestSearchAPI/v3/"
          const params = {
            keyid: "9520c6838a4f82f8cb7389cbbc1d7215",
            latitude: lat,
            longitude: lng,
            range: 5
          }
          $.getJSON( url, params,result => {
        showResult( result )})
      
        const showResult = result => {
        result.rest.map( item => {
          $("#table").append(`<tr><td>${item.name}</td><td>${item.address}</td></tr>`)
        })
      }
         },
        // 取得失敗した場合
        function(error) {
          switch(error.code) {
            case 1: //PERMISSION_DENIED
              alert("位置情報の利用が許可されていません");
              break;
            case 2: //POSITION_UNAVAILABLE
              alert("現在位置が取得できませんでした");
              break;
            case 3: //TIMEOUT
              alert("タイムアウトになりました");
              break;
            default:
              alert("その他のエラー(エラーコード:"+error.code+")");
              break;
          }
        }
      );
    }
			


    
  </script>
</body>
</html>